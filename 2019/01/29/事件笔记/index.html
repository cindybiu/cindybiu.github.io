<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>事件读书笔记 - cindyBlog</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="http://callfiles.ueibo.com/hexo-theme-laughing/post_background.jpg"><div class="post-title"><h1 class="title">事件读书笔记</h1><ul class="meta"><li><i class="icon icon-author"></i>cindy Liu</li><li><i class="icon icon-clock"></i>19 Minutes</li><li><i class="icon icon-calendar"></i>January 29, 2019</li></ul></div></div><div class="article-content" style="max-width:800px"><p><img src="https://images.pexels.com/photos/1874613/pexels-photo-1874613.jpeg?auto=compress&amp;cs=tinysrgb&amp;h=650&amp;w=940" alt=""></p>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h6 id="本章内容-（p363-p429）"><a href="#本章内容-（p363-p429）" class="headerlink" title="本章内容 （p363-p429）"></a>本章内容 （p363-p429）</h6><ul>
<li>理解事件流</li>
<li>使用事件处理程序</li>
<li>不同的事件类型<a id="more"></a>
<h5 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h5><blockquote>
<p>事件流描述的是从页面接收事件的顺序。但是IE 和 Netscape 开发团队提出了相反的事件流感念，IE的事件流是事件冒泡流，而Netscape 的事件流是事件捕获流。</p>
</blockquote>
</li>
</ul>
<p>DOM2级事件规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段和事件冒泡阶段</p>
<h5 id="DOM0级事件处理程序"><a href="#DOM0级事件处理程序" class="headerlink" title="DOM0级事件处理程序"></a>DOM0级事件处理程序</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;myBtn&quot;)</span><br><span class="line">btn.onclick = function()&#123;</span><br><span class="line">    alert(&quot;click&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 删除事件处理程序</span><br><span class="line">btn.onclick = null</span><br></pre></td></tr></table></figure>
<h5 id="DOM2级事件处理程序"><a href="#DOM2级事件处理程序" class="headerlink" title="DOM2级事件处理程序"></a>DOM2级事件处理程序</h5><p>定义了两个方法，用于处理制定和删除事件程序的操作：addEventListener() 和 removeEventListener()。所有DOM节点都包含这两个方法，并且都接受3个参数：</p>
<ul>
<li>要处理的事件名</li>
<li>作为事件处理程序的函数</li>
<li>一个布尔值（true表示在捕获阶段调用，false表示在冒泡阶段）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//该事件会再冒泡阶段被触发</span><br><span class="line">var btn = document.getElementById(&quot;myBtn&quot;)</span><br><span class="line">btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">    alert(this.id)</span><br><span class="line">&#125;,false)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>使用DOM2级方法的除妖好处是可以添加多个事件处理程序,多个程序会按添加顺序触发<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;myBtn&quot;);</span><br><span class="line"></span><br><span class="line">btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">    alert(this.id;)</span><br><span class="line">&#125;,false)</span><br><span class="line"></span><br><span class="line">btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">    alert(&quot;Hello world&quot;);</span><br><span class="line">&#125;,false)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>通过addEventListener()添加的事件只能通过removeEventLisener() 来移除，移除时传入的参数与添加时候的参数相同，以为着通过addEventListener()添加的匿名函数将无法移除。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//以下移除方法removeEventLisener()无效,因为第二个参数是一个完全不同的函数</span><br><span class="line">var btn = document.getElemetnById(&quot;myBtn&quot;)</span><br><span class="line">btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">    alert(this.id;)</span><br><span class="line">&#125;,false)</span><br><span class="line">btn.removeEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">    alert(this.id;)</span><br><span class="line">&#125;,false)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//以下移除方法有效</span><br><span class="line">var btn = document.getElemetnById(&quot;myBtn&quot;)</span><br><span class="line">btn.addEventListener(&quot;click&quot;,hendler,false)</span><br><span class="line">btn.removeEventListener(&quot;click&quot;,hendler,false)</span><br></pre></td></tr></table></figure>
<p><strong> 如果不是特别需要，我们不建议在事件捕获阶段注册事件处理程序。大多数情况下都是在冒泡阶段，可以最大限度地兼容各种浏览器 </strong></p>
<h5 id="IE事件处理程序"><a href="#IE事件处理程序" class="headerlink" title="IE事件处理程序"></a>IE事件处理程序</h5><p>….</p>
<h5 id="跨浏览器的事件处理程序"><a href="#跨浏览器的事件处理程序" class="headerlink" title="跨浏览器的事件处理程序"></a>跨浏览器的事件处理程序</h5><p>要保证处理事件的代码在大多数浏览器下一致地运行，只需关注冒泡阶段。<br>(以下代码最好记下来)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">    addHandler: funciton(element, type, handler)&#123;</span><br><span class="line">        if(element.addEventListener)&#123;</span><br><span class="line">            element.addEventListener(type, handler, false)</span><br><span class="line">        &#125;else if(element.attachEvent)&#123;</span><br><span class="line">            element.attachEvent(&apos;on&apos;+type, handler)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            element[&apos;on&apos;+type] = handler;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    removeHandler: function(element, type ,handler)&#123;</span><br><span class="line">        if(element.removeEventListener)&#123;</span><br><span class="line">            element.removeEventListener(type, handler, false)</span><br><span class="line">        &#125;else if(element.datachEvent)&#123;</span><br><span class="line">            element.datachEvent(&apos;on&apos;+type, handler)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            element[&apos;on&apos;+type] = null</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//以下是调用方式</span><br><span class="line">var btn = document.getElementById(&quot;myBtn&quot;)</span><br><span class="line">var handler = function()&#123;</span><br><span class="line">    alert(&quot;Cliked&quot;)</span><br><span class="line">&#125;;</span><br><span class="line">EventUtil.addHandler(btn, &quot;click&quot;, handler)</span><br><span class="line">//这里省略了其他代码</span><br><span class="line">EventUtil.removeHandler(btn, &quot;click&quot;, handler)</span><br></pre></td></tr></table></figure></p>
<h5 id="事件对象event"><a href="#事件对象event" class="headerlink" title="事件对象event"></a>事件对象event</h5><p>触发DOM上的某个事件时，会产生一个事件对象event，包含与事件有关的信息。<br>常用的属性方法：<br>属性/方法 | 说明<br>—|—<br>currentTarget | 其事件处理程序当前正在处理事件的那个元素<br>target | 事件的目标<br>preventDefault() | 取消事件的默认行为<br>stopPropagation() | 取消事件的进一步捕获或冒泡，同时组织任何事件处理程序被调用</p>
<h6 id="currentTarget-和-target-的区别"><a href="#currentTarget-和-target-的区别" class="headerlink" title="currentTarget 和 target 的区别"></a>currentTarget 和 target 的区别</h6><p>在事件处理程序内部，this始终等于currentTartget的值，而target则只包含事件的实际目标。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 如果直接将事件处理程序制定给了缪奥元素，则this、currentTarget和terget包含相同的值</span><br><span class="line">var btn = document.getElementById(&quot;myBtn&quot;)</span><br><span class="line">btn.onclick = function(event)&#123;</span><br><span class="line">    alert(event.currentTarget === this) //ture</span><br><span class="line">    alert(evnet.target === this ) // ture</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//如果事件处理程序存于父结点中，那么这些值是不同的</span><br><span class="line">document.body.onclick = function(event)&#123;</span><br><span class="line">    alert(event.currentTarget === document.body ) //ture</span><br><span class="line">    alert(document.body === this ) //ture</span><br><span class="line">    alert(event.target === document.getElementById(&quot;myBtn&quot;)) // ture</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="preventDefault-取消默认行为"><a href="#preventDefault-取消默认行为" class="headerlink" title="preventDefault() 取消默认行为"></a>preventDefault() 取消默认行为</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var link = document.getElementById(&quot;myLink&quot;)</span><br><span class="line">link.onclick = function(event)&#123;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="stopPropagation-立即停止事件在DOM层次中的传播，取消进一步的事件捕获或冒泡"><a href="#stopPropagation-立即停止事件在DOM层次中的传播，取消进一步的事件捕获或冒泡" class="headerlink" title="stopPropagation() 立即停止事件在DOM层次中的传播，取消进一步的事件捕获或冒泡"></a>stopPropagation() 立即停止事件在DOM层次中的传播，取消进一步的事件捕获或冒泡</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;myBtn&quot;)</span><br><span class="line">btn.onclick = function(event)&#123;</span><br><span class="line">    alert(&quot;clicked&quot;)</span><br><span class="line">    event.stopPropagation</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">document.body.onclick = function(event)&#123;</span><br><span class="line">    alert(&quot;body clicked&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="eventPhase-属性-判断事件处于哪个阶段"><a href="#eventPhase-属性-判断事件处于哪个阶段" class="headerlink" title="eventPhase 属性 判断事件处于哪个阶段"></a>eventPhase 属性 判断事件处于哪个阶段</h6><h4 id="事件类型"><a href="#事件类型" class="headerlink" title="事件类型"></a>事件类型</h4><ul>
<li>UI事件<ul>
<li>load:当页面完全加载后在window上面触发</li>
<li>error：当发生js错误时在window上面触发</li>
<li>select:当用户选择文本框中的一或多个字符时触发</li>
<li>resize:当窗口或框架的大小变化时在window或框架上面触发</li>
<li>scroll：当用户滚动带滚动条的元素中的内容时，在该元素上面触发</li>
</ul>
</li>
<li>焦点事件</li>
<li>鼠标事件</li>
<li>滚轮事件</li>
<li>文本事件</li>
<li>键盘事件</li>
<li>合成事件</li>
<li>变动事件（当底层DOM结构发生变化时触发）</li>
</ul>
<h5 id="load-图片懒加载"><a href="#load-图片懒加载" class="headerlink" title="load 图片懒加载"></a>load 图片懒加载</h5><p><a href="https://www.jianshu.com/p/4876a4fe7731" target="_blank" rel="noopener">懒加载和预加载</a></p>
<h4 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h4><p>对“事件处理程序过多”的解决方案就是事件委托。事件委托利用了事件冒泡，制定一个事件处理程序，就可以管理某一类型的所有事件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// html</span><br><span class="line">&lt;ul id = &quot;myLinks&quot;&gt;</span><br><span class="line">    &lt;li id=&quot;goSomewhere&quot;&gt; Go Somewhere&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;doSomething&quot;&gt; Do Something&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;sayHi&quot;&gt; Say Hi&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure></p>
<p>按照传统的方法，要为他们添加3个事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var item1 = document.getElementById(&quot;goSomewhere&quot;)</span><br><span class="line">var item2 = document.getElementById(&quot;doSomething&quot;)</span><br><span class="line">var item3 = document.getElementById(&quot;sayHi&quot;)</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(item1,&quot;click&quot;,function(event)&#123;</span><br><span class="line">    location.href = &apos;http://www.wrox.com&apos;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(item2,&quot;click&quot;,function(event)&#123;</span><br><span class="line">    document.title = &quot;I changed the document&apos;s title &quot;</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(item3,&quot;click&quot;,function(event)&#123;</span><br><span class="line">    alert(&quot;hi&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>使用事件委托，只需要在DOM树中尽量最高的层次上添加一个事件处理程序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var list = document.getElementById(&quot;myLinks&quot;)</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(list,&apos;click&apos;,function(event)&#123;</span><br><span class="line">    event = EventUtil.getEvent(event)</span><br><span class="line">    var target = EventUtil.getTarget(event)</span><br><span class="line"></span><br><span class="line">    switch(target.id)&#123;</span><br><span class="line">        case &quot;doSomething&quot;:</span><br><span class="line">        document.title = &quot;I changed the document&apos;s title &quot;</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">        case &quot;goSomewhere&quot;:</span><br><span class="line">        location.href = &apos;http://www.wrox.com&apos;</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">        case &quot;sayHi&quot;:</span><br><span class="line">        alert(&quot;hi&quot;)</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>事件委托的优点是需要占用的内存更少，对DOM的操作更少。</p>
</blockquote>
</div><div class="article-meta" style="max-width:800px"><div class="categories"><i class="icon icon-category"></i><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a><span class="category-list-count">17</span></li></ul></div></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="cjs5p3x4g000tf8vxqrgfxv80" data-title="事件读书笔记" data-url="http://yoursite.com/2019/01/29/事件笔记/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2019/01/22/wepack学习笔记/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/cindybiu" title="Github" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="https://weibo.com/p/1005052090323133" title="Weibo" target="_blank"><i class="icon icon-weibo"></i></a></li><li><a title="SegmentFault" target="_blank"><i class="icon icon-segmentfault"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2019 cindyBlog<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>